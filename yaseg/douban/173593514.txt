解决openSUSE 11.4 的Apparmor 造成不能查看Samba 的共享文件

Samba 配置如下：## Shared for update web site by Terry[up]        comment = Shared for update web site.        path = /var/workspace/share        public = No        browseable = Yes        printable = No        write list = @users        create mode = 0664        directory mode = 0775用户能登录共享，ls 看文件却报错： NT_STATUS_ACCESS_DENIED listing \*Google 告诉我说是openSUSE 11.4 的AppArmor 和Samba 有冲突，于是乎运行rcapparmor stop ; rcsmb restart，一切正常，看来这个问题真的是由AppArmor 造成的。以前只接触过RHEL 的SELinux，解决AppArmor 问题还是头一回，翻了Novell 的AppArmor文档，解决方法如下：update:~ # vim /etc/apparmor.d/usr.sbin.smbd# vim:syntax=apparmor# Last Modified: Wed Jun 20 13:34:25 2007#include <tunables/global>/usr/sbin/smbd {  #include <abstractions/authentication>  #include <abstractions/base>  #include <abstractions/consoles>  #include <abstractions/cups-client>  #include <abstractions/nameservice>  #include <abstractions/samba>  #include <abstractions/user-tmp>  #include <abstractions/wutmp>  capability net_bind_service,  capability setgid,  capability setuid,  capability sys_resource,  capability sys_tty_config,  /etc/mtab r,  /etc/printcap r,  /proc/*/mounts r,  /usr/sbin/smbd mr,  /etc/samba/* rwk,  /etc/samba/passdb.tdb rwk,  /etc/samba/secrets.tdb rwk,  /var/cache/samba/** rwk,  /var/cache/samba/printing/printers.tdb mrw,  /var/lib/samba/** rwk,  /var/lib/samba/printers/** rw,  /var/run/cups/cups.sock rw,  /var/run/dbus/system_bus_socket rw,  /var/run/samba/** rk,  /var/run/samba/smbd.pid rw,  /var/log/samba/cores/smbd/ rw,  /var/log/samba/cores/smbd/** rw,  /var/spool/samba/** rw,  #  # 下面2 行是新添加的，用于配置Samba 共享目录的访问权限。  #  /var/workspace/share/ r,  /var/workspace/share/** rwkix,  @{HOMEDIRS}/** lrwk,}保存退出，然后执行 rcapparmor restart ; rcsmb restart 即可正常访问。Tips:清除Windows 保存的网络用户和密码 C:\Users\sahu>net use * /del /y参考资源：-  